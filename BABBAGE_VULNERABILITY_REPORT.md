# Vulnerability Report for Babbage Team
## bitcoin-writer npm Dependencies

**Report Date:** December 7, 2025  
**Project:** bitcoin-writer v2.0.0  
**Prepared for:** Babbage Development Team

---

## Executive Summary

This report documents 18 npm vulnerabilities found in the bitcoin-writer project that directly impact Babbage packages (`@babbage/escrow` and deprecated `@babbage/sdk-ts`). These vulnerabilities are **NOT related to the React2Shell (CVE-2025-55182) vulnerability** but are long-standing issues in cryptographic and utility libraries.

### Key Findings:
- **These are NOT React2Shell related** - React2Shell only affects React 19.x; this project uses React 18.3.1
- **These are generic npm package vulnerabilities** that have existed for months/years
- **They ARE specific to your implementation** because you depend on vulnerable Babbage packages

---

## Critical Vulnerabilities Affecting Babbage Packages

### 1. Elliptic Library (CVSS: Critical)
**Impact on Babbage:** Direct via `babbage-bsv` dependency

**Vulnerabilities:**
- **CVE-2024-48948**: Private key extraction in ECDSA upon signing malformed input
- **CVE-2024-48949**: EDDSA missing signature length check
- **CVE-2024-42461**: Missing check for leading bit of r and s being zero
- **CVE-2024-42460**: Allows BER-encoded signatures
- **CVE-2023-26115**: Valid ECDSA signatures erroneously rejected
- **CVE-2024-28498**: Verify function omits uniqueness validation

**Affected Dependency Chain:**
```
@babbage/escrow → scrypt-ts-lib → rabinsig → babbage-bsv → elliptic@6.6.0
pushdrop → babbage-bsv → elliptic@6.6.0
tokens-topic-manager → babbage-bsv/pushdrop → elliptic@6.6.0
```

**Risk Assessment:** These vulnerabilities allow attackers to:
- Extract private keys from wallet operations
- Bypass signature verification
- Create malformed signatures that appear valid

### 2. BigInt-Buffer Overflow (CVSS: High) 
**Impact on Babbage:** Via `@babbage/escrow`

**Vulnerability:** Buffer overflow via toBigIntLE() function allowing memory corruption

**Affected Dependency Chain:**
```
@babbage/escrow → scrypt-ts-lib → rabinsig → bigint-buffer
```

**Risk Assessment:** Could allow attackers to:
- Corrupt memory during BigInt operations
- Potentially execute arbitrary code
- Compromise escrow transaction processing

### 3. PBKDF2 Key Generation (CVSS: Critical)
**Impact on Babbage:** Indirect via BSV library

**Vulnerabilities:**
- **CVE-2025-55613**: Silently disregards Uint8Array input, returning static keys
- **CVE-2025-55614**: Returns predictable uninitialized/zero-filled memory

**Affected Package:** `bsv@2.0.10` (used alongside Babbage packages)

**Risk Assessment:** 
- Wallet seeds and private keys could be predictable
- Previously "secure" wallets may have known keys

---

## Deprecation Warnings

The npm install warns about deprecated Babbage packages:
```
npm warn deprecated pushdrop@0.1.64: Please use the PushDrop template from @bsv/sdk
npm warn deprecated @babbage/sdk-ts@0.2.75: Please use WalletClient from @bsv/sdk
```

**Recommendation:** Migrate to `@bsv/sdk` for maintained, secure alternatives.

---

## Remediation Steps for Babbage Team

### Immediate Actions Required:

1. **Update `babbage-bsv` package**
   - Upgrade elliptic dependency to v6.6.1 or higher
   - This fixes all 6 critical ECDSA/EDDSA vulnerabilities

2. **Update `@babbage/escrow` dependencies**
   - Fix bigint-buffer vulnerability in the rabinsig/scrypt-ts-lib chain
   - Consider alternative BigInt handling libraries

3. **Deprecation Migration Path**
   - Provide migration guide from `@babbage/sdk-ts` to `@bsv/sdk` WalletClient
   - Update pushdrop implementations to use `@bsv/sdk` templates

### For bitcoin-writer Project Specifically:

1. **No React2Shell risk** - React 18.3.1 and Next.js 15.5.7 are safe
2. **Cannot fix independently** - These vulnerabilities are in Babbage's transitive dependencies
3. **Temporary mitigation**: Monitor for unusual wallet behavior or signature failures

---

## Vulnerability Classification

**Answer to your questions:**

1. **Are these related to React2Shell?** 
   - No, completely unrelated. React2Shell affects React 19.x Server Components

2. **Are these generic vulnerabilities?**
   - Yes, these are known CVEs affecting multiple npm packages industry-wide

3. **Are these specific to your implementation?**
   - Yes, because you specifically depend on vulnerable Babbage packages
   - No, in that any project using these Babbage packages has the same vulnerabilities

---

## Timeline & Priority

**Critical Priority** (Fix within 48 hours):
- Elliptic ECDSA vulnerabilities (wallet key extraction risk)
- PBKDF2 predictable keys

**High Priority** (Fix within 1 week):
- BigInt buffer overflow in escrow operations

**Medium Priority** (Fix within 1 month):
- Package deprecation migrations
- Remaining moderate severity issues

---

## Contact & Support

For questions about this report or assistance with remediation:
- File issues at Babbage GitHub repositories
- Consider coordinated disclosure if new attack vectors are discovered
- Monitor npm audit regularly as new vulnerabilities are discovered

---

**Note:** This report focuses only on vulnerabilities directly impacting Babbage packages. Additional vulnerabilities exist in HandCash SDK, react-quill, and other third-party dependencies that should be addressed separately.